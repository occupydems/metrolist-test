name: Setup and Generate Protobuf
description: Install protoc and generate protobuf files

runs:
  using: composite
  steps:
    - name: Install protoc
      run: |
        if ! command -v protoc &> /dev/null; then
          sudo apt-get update -qq
          sudo apt-get install -y -qq protobuf-compiler > /dev/null 2>&1
        fi
      shell: bash

    - name: Generate protobuf files
      run: |
        cd app
        bash generate_proto.sh
      shell: bash
